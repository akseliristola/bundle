(()=>{"use strict";var t=document.createElement("div");t.style.width="25px",t.style.height="25px",t.style.position="absolute",t.style.top="10px",t.style.right="10px",t.style.cursor="pointer";var e=document.createElement("div"),n=document.createElement("div");n.style.width="110%",n.style.height="2px",n.style.backgroundColor="white",n.style.transform="rotate(45deg)",n.style.position="absolute",n.style.top="50%",n.style.left="0";var l=document.createElement("div");l.style.width="110%",l.style.height="2px",l.style.backgroundColor="white",l.style.transform="rotate(-45deg)",l.style.position="absolute",l.style.top="50%",l.style.left="0",e.appendChild(n),e.appendChild(l),t.appendChild(e);const i=t,o=function(t,e,n){var l=document.createElement("div");l.id="chatHeader",l.style.width="94.6%",l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="start",l.style.height="5%",l.style.borderRadius="10px 10px 0px 0px",l.style.backgroundColor="#041F3E",l.style.color="white",l.style.padding="10px",l.style.alignSelf="flex-start";var o=document.createElement("img");o.src="https://storage.googleapis.com/emeric-logo/last.png",o.alt="logo",o.title="logo",o.style.width="60px",o.style.cursor="pointer",o.addEventListener("click",(function(){window.open("https://emeric.ai/","_blank")}));var r=function(){var t=document.createElement("div");t.style.width="25px",t.style.height="25px",t.style.position="absolute",t.style.top="10px",t.style.right="50px",t.style.cursor="pointer";var e=document.createElement("div");e.style.width="25px",e.style.height="25px",e.style.backgroundColor="white",e.style.borderRadius="50%",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center";var n=document.createElement("div");n.style.width="22px",n.style.height="22px",n.style.backgroundColor=window.ChatComponentMainColor,n.style.borderRadius="50%";var l=document.createElement("div");l.style.width="25px",l.style.height="25px",l.style.backgroundColor=window.ChatComponentMainColor,l.style.position="absolute",l.style.right="11px",l.style.top="11px";var i=document.createElement("div");return i.style.width="0",i.style.height="0",i.style.borderLeft="4px solid white",i.style.borderTop="4px solid transparent",i.style.borderBottom="4px solid transparent",i.style.transform="rotate(90deg)",i.style.left="-1px",i.style.position="absolute",e.appendChild(l),e.appendChild(n),e.appendChild(i),t.appendChild(e),t}();return r.addEventListener("click",(function(){n()})),l.appendChild(o),l.appendChild(r),l.appendChild(i),i.addEventListener("click",(function(){var n;n=e,t.style.display="none",n.style.display="flex"})),l};var r=document.createElement("div");r.style.width="40px",r.style.height="40px",r.style.border="2px solid #041F3E",r.style.borderRadius="50%",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center",r.style.minWidth="40px",r.style.maxWidth="40px",r.style.minHeight="40px",r.style.maxHeight="40px";var s=document.createElement("img");s.src="https://storage.googleapis.com/emeric-logo/download.svg",s.alt="logo",s.title="logo",s.style.width="30px",s.style.height="30px",r.appendChild(s),r.style.marginRight="5px";const a=r;var d="@keyframes dot {\n    0% { background-color: grey; transform: scale(1); }\n    50% { background-color: #333333; transform: scale(1.3); }\n    100% { background-color: grey; transform: scale(1); }\n}",p=document.createElement("style");if(p.type="text/css","sheet"in p)p.appendChild(document.createTextNode(d)),document.head.appendChild(p);else{var c=document.styleSheets[0]||document.styleSheets.item(0);c.insertRule(d,c.cssRules.length)}var y=document.createElement("div");y.classList.add("loading"),y.style.alignItems="center",y.style.display="flex",y.style.justifyContent="center",y.style.height="20px",y.style.width="80px",y.style.backgroundColor="#f2f2f2",y.style.padding="5px",y.style.borderRadius="8px",y.style.marginTop="5px",y.style.marginLeft="0px",y.style.alignSelf="flex-start";for(var h=0;h<3;h++){var u=document.createElement("span");u.classList.add("loading__dot"),u.style.backgroundColor="grey",u.style.display="inline-block",u.style.height="7px",u.style.margin="10px",u.style.width="10px",u.style.borderRadius="7px",u.style.animation="dot ease-in-out 1s infinite",1===h?u.style.animationDelay="0.2s":2===h&&(u.style.animationDelay="0.3s"),y.appendChild(u)}const m=y;var f=document.createElement("div");f.style.backgroundColor="#f2f2f2",f.style.color="black",f.style.borderRadius="8px",f.style.padding="10px",f.style.fontFamily="Arial",f.style.fontSize="14px",f.style.fontWeight="500";var x=document.createElement("div");x.style.display="flex",x.style.flexDirection="row",x.style.marginTop="20px";const g=function(t,e){var n=x.cloneNode(!0);if("dots"===t)n.style.maxWidth="90%",n.style.alignSelf="flex-start",n.style.marginLeft="5px",n.appendChild(a.cloneNode(!0)),n.appendChild(m);else{"assistant2"===t.role?e.push({role:"assistant",content:t.content}):e.push(t);var l=f.cloneNode(!0);l.innerHTML=t.content.replace(/(\bhttps?:\/\/[^\s]+|\bwww\.[^\s]+)/g,(function(t){return'<a href="'+(t.startsWith("http")?t:"http://"+t)+'" target="_blank">'+t+"</a>"})),"user"===t.role?(n.style.maxWidth="80%",n.style.alignSelf="flex-end",n.style.marginRight="5px"):"assistant2"===t.role?(n.style.maxWidth="70%",n.style.alignSelf="flex-start",n.style.marginLeft="15.5%",n.style.marginRight="5px"):(n.style.maxWidth="80%",n.style.alignSelf="flex-start",n.style.marginLeft="5px",n.appendChild(a.cloneNode(!0))),n.appendChild(l)}return n};function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,l=new Array(e);n<e;n++)l[n]=t[n];return l}const C=function(t){var e=document.createElement("div");e.style.height="190px",e.style.maxWidth="98%",e.style.display="flex",e.style.flexDirection="row",e.style.marginTop="12px",e.style.marginLeft="1%",e.style.marginRight="1%",e.style.gap="4px",e.style.overflowX="scroll";var n,l=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var l=0,i=function(){};return{s:i,n:function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}(t.map((function(t){return t.note})));try{for(l.s();!(n=l.n()).done;){var i=n.value,o=document.createElement("div");o.style.width="140px",o.style.height="178px",o.style.border="0.5px solid grey",o.style.display="flex",o.style.justifyContent="start",o.style.flexDirection="column",o.style.cursor="pointer",o.addEventListener("click",(function(){window.open(i.link,"_blank")}));var r=document.createElement("img");r.style.width="140px",r.style.height="120px",r.src=i.url,o.appendChild(r);var s=document.createElement("div");s.style.width="140px",s.style.fontSize="9px",s.innerText=i.name,o.appendChild(s);var a=document.createElement("div");a.style.width="140px",a.style.fontSize="9px",a.innerText=i.price,o.appendChild(a);var d=document.createElement("div");d.style.width="140px",d.style.height="40px",d.style.fontSize="6px",d.innerText=i.description,o.appendChild(d),e.appendChild(o)}}catch(t){l.e(t)}finally{l.f()}return e},b=function(t,e){var n=document.createElement("div");return n.id="buttonsContainer",n.style.width="100%",n.style.display="flex",n.style.flexDirection="column",n.style.gap="6px",n.style.alignItems="start",n.style.justifyContent="center",n.style.marginTop="10px",n.style.marginLeft="3px",n.style.marginBottom="2px",t.forEach((function(t){var l=document.createElement("button");l.style.marginRight="10px",l.style.backgroundColor="white",l.style.color=window.ChatComponentMainColor,l.style.border="1.5px solid #041F3E",l.style.borderRadius="15px",l.style.padding="5px 10px",l.style.cursor="pointer",l.style.width="70%",l.style.display="flex",l.style.fontFamily="Arial",l.style.fontSize="12px",l.innerText=t.text,l.addEventListener("mouseenter",(function(){l.style.backgroundColor="#041F3E",l.style.color="white"})),l.addEventListener("mouseleave",(function(){l.style.backgroundColor="white",l.style.color="#041F3E"})),l.addEventListener("click",(function(){e(t)})),n.appendChild(l)})),n},w={finnish:[{title:{title:"Hei, osaan auttaa sinua yritykseemme koskevissa kysymyksissä. Kuinka voin olla avuksi?",id:"9918401",connection:"0"},texts:[],endpoint:""},{title:{title:"Anteeksi, mutta en löydä yrityksemme datasta vastausta kysymykseesi. Voit yrittää muotoilla kysymyksesi uudelleen tai ottaa yhteyttä.",id:"6302862",connection:""},texts:[{text:"Haluan ottaa yhteyttä",id:"4251884",connection:"1429341"}],endpoint:"?"},{title:{title:"!Selvä! Voisitko antaa puhelinnumerosi tai sähköpostiosoitteesi, jotta voimme olla yhteydessä sinuun?",id:"1429341",connection:"4251884"},texts:[{text:"Kiitos, olemme sinuun yhteydessä päivän sisällä!",id:"1061854",connection:"4779522"}],endpoint:""},{title:{title:"",id:"4644050",connection:""},texts:[],endpoint:""}]};function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,l=new Array(e);n<e;n++)l[n]=t[n];return l}var k,T,S,L,A,R,j,I,z,H,F=w.finnish,D="https://emeric-backend-finaali-z573vwoula-lz.a.run.app",N=!1,O=null,W=[],B="finnish",M=document.getElementById("viraltop-script");z=window.history,H=z.pushState,z.pushState=function(t,e,n){return j.concat(I).length>0&&(j.includes(n.split("/")[1])&&!I.includes(n.split("/")[1])?A.style.display="block":A.style.display="none"),H.apply(z,[t,e,n])},document.addEventListener("DOMContentLoaded",(function(){try{j=M.getAttribute("allowed-paths").split(",")}catch(t){j=[]}try{I=M.getAttribute("banned-paths").split(",")}catch(t){I=[]}try{R=M.getAttribute("border")}catch(t){R="none"}var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.display="flex",t.style.flexDirection="column",t.style.overflow="scroll",t.style.scrollBehavior="smooth",t.style.padding="1px",t.style.fontFamily="Arial";var e,n,l=M.getAttribute("data-param1"),i=M.getAttribute("color");window.ChatComponentMainColor=(e=i,(n=(new Option).style).color=e,""!==n.color?i:"#041F3E");var r,s=M.getAttribute("position");r="bottom-right"===s?["bottom","right"]:"top-right"===s?["top","right"]:"top-left"===s?["top","left"]:["bottom","left"];var a=F.find((function(t){return"0"===t.title.connection}));function d(e){if(!N){N=!0;try{t.removeChild(S)}catch(t){}var n=g({role:"user",content:e.text},W);t.appendChild(n);var i=g("dots",W);t.appendChild(i),t.scrollTop=t.scrollHeight,setTimeout((function(){t.removeChild(i);try{var n=F.find((function(t){return t.title.id===e.connection}));if(n.title.title.startsWith("!")){var o=g({role:"assistant",content:n.title.title.slice(1)},W);t.appendChild(o),L=function(t,e,n,l,i){var o=document.createElement("div");o.style.width="250px",o.style.display="flex",o.style.flexDirection="column",o.style.gap="6px",o.style.padding="10px",o.style.border="1px solid grey",o.style.marginLeft="50%",o.style.transform="translateX(-50%)",o.style.marginTop="10px",o.style.fontSize="14px";var r=document.createElement("div");r.style.display="flex",r.style.flexDirection="column",r.style.gap="6px";var s=document.createElement("span");s.innerText="Email";var a=document.createElement("input");r.appendChild(s),r.appendChild(a),o.appendChild(r);var d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.gap="6px";var p=document.createElement("span");p.innerText="Puhelinnumero";var c=document.createElement("input");d.appendChild(p),d.appendChild(c),o.appendChild(d);var y=document.createElement("div");y.style.display="flex",y.style.flexDirection="column",y.style.gap="6px";var h=document.createElement("span");h.innerText="Lisättävää?";var u=document.createElement("textarea");u.style.resize="none",u.style.fontSize="12px",y.appendChild(h),y.appendChild(u),o.appendChild(y);var m=document.createElement("button");return m.innerText="Lähetä",m.addEventListener("click",(function(){e.removeChild(o);var r=g("dots",n);e.appendChild(r),e.scrollTop=e.scrollHeight;var s=o.childNodes,a={prevChats:n,phone:s[0].childNodes[1].value,email:s[1].childNodes[1].value,text:s[2].childNodes[1].value},d={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch("".concat(l,"/chatEmail/").concat(i),d).then((function(l){e.removeChild(r);var i=t[0].text,o=g({role:"assistant",content:i},n);e.appendChild(o),e.scrollTop=e.scrollHeight})).catch((function(t){try{e.removeChild(r)}catch(t){}var l=g({role:"assistant",content:"Error"},n);e.appendChild(l),e.scrollTop=e.scrollHeight}))})),o.appendChild(m),o}(n.texts,t,W,D,l),t.appendChild(L)}else{var r=g({role:"assistant",content:n.title.title},W);if(t.appendChild(r),n.texts.length>0){var s=n.texts.filter((function(t){return t.text.startsWith("@")}));if(s.length>0){var a=C(s);t.appendChild(a)}n.texts.filter((function(t){return!t.text.startsWith("@")})).length>0&&(S=b(n.texts,d),t.appendChild(S))}}t.scrollTop=t.scrollHeight,N=!1}catch(e){var p=g({role:"assistant",content:"Error"},W);t.appendChild(p),t.scrollTop=t.scrollHeight,N=!1}}),2e3)}}function p(){if(!N){for(W=[k];t.firstChild;)t.removeChild(t.firstChild);if(t.appendChild(T),O=null,a&&a.texts&&a.texts.length>0){var e=a.texts;S=b(e,d),t.appendChild(S)}}}if(void 0===a)k={role:"assistant",content:"Hei, miten voin auttaa sinua?"};else if(k={role:"assistant",content:a.title.title},a.texts&&a.texts.length>0){var c=a.texts;S=b(c,d)}T=g(k,W),t.appendChild(T),S&&t.appendChild(S);var y=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var l,i,o,r,s=[],a=!0,d=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;a=!1}else for(;!(a=(l=o.call(n)).done)&&(s.push(l.value),s.length!==e);a=!0);}catch(t){d=!0,i=t}finally{try{if(!a&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(d)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(function(t,e){var n=document.createElement("div");n.style.width="55px",n.style.height="55px",n.style.borderRadius="40px",n.style.backgroundColor=window.ChatComponentMainColor,n.style.position="fixed",n.style.zIndex="1000",n.style.cursor="pointer",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.fontSize="26px",n.style[t[0]]="10px",n.style[t[1]]="10px",n.style.border=e;var l=function(){var t=document.createElement("div"),e=document.createElement("div");e.style.width="20px",e.style.height="18px",e.style.borderRadius="5px",e.style.backgroundColor="white",e.style.position="absolute",e.style.left="17px",e.style.bottom="20px",e.style.zIndex="1";var n=document.createElement("div");return n.style.borderLeft="5px solid transparent",n.style.borderRight="5px solid transparent",n.style.borderTop="10px solid white",n.style.position="absolute",n.style.bottom="15px",n.style.left="14px",n.style.transform="rotate(40deg)",t.appendChild(e),t.appendChild(n),t}();n.appendChild(l);var i=document.createElement("div");return i.className="chatDiv",i.style.width="350px",i.style.display="none",i.style.height="560px",i.style.position="fixed",i.style.zIndex="1000",i.style.flexDirection="column",i.style.fontSize="16px",i.style.border="0.1px solid grey",i.style.backgroundColor="white",i.style.borderRadius="10px",i.style[t[0]]="2px",i.style[t[1]]="2px",[i,n]}(r,R),2),h=y[0],u=y[1],m=function(t){var e=document.createElement("div"),n=document.createElement("div");n.style.width="0",n.style.height="0",n.style.borderLeft="20px solid white",n.style.borderTop="10px solid transparent",n.style.borderBottom="10px solid transparent",n.style.position="relative",n.style.bottom="0",n.style.zIndex="1";var l=document.createElement("div");l.style.width="0",l.style.height="0",l.style.borderLeft="15px solid ".concat(window.ChatComponentMainColor),l.style.borderTop="1.9px solid transparent",l.style.borderBottom="1.9px solid transparent",l.style.top="11.5px",l.style.position="relative",l.style.zIndex="2",e.appendChild(l),e.appendChild(n),e.style.display="inline-block";var i=document.createElement("div");i.style.width="100%",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="start",i.style.bottom="0",i.style.marginBottom="2px",i.style.marginTop="4px",i.style.paddingBottom="4px";var o=document.createElement("textarea");o.style.resize="none",o.style.overflowY="auto",o.style.width="75%",o.style.fontFamily="Arial",o.style.height="40px",o.style.marginLeft="5px",o.placeholder="Kirjoita chattisi tähän",o.style.padding="4px",o.style.borderRadius="5px";var r=document.createElement("button");return r.style.width="15%",r.style.height="40px",r.style.backgroundColor=window.ChatComponentMainColor,r.style.border="none",r.style.borderRadius="5px",r.style.marginLeft="10px",r.style.cursor="pointer",r.appendChild(e),i.appendChild(o),i.appendChild(r),o.addEventListener("keydown",(function(e){if(13===e.keyCode){e.preventDefault();try{o.blur(),t(o),o.value=""}catch(t){}}})),r.addEventListener("click",(function(){try{o.blur(),t(o)}catch(t){}})),i}((function(e){if(!N){N=!0;var n=g({role:"user",content:e.value},W);try{t.removeChild(S)}catch(t){}try{t.removeChild(L)}catch(t){}t.appendChild(n);var i=g("dots",W);t.appendChild(i),t.scrollTop=t.scrollHeight;var o={chats:W,id:O,language:B};e.value="",fetch("".concat(D,"/chatbot/").concat(l),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(t){if(!t.ok)throw N=!1,new Error("Network response was not ok");return t.json()})).then((function(e){if(e.id&&(O=e.id),t.removeChild(i),""!==e.result){var n=g({role:"assistant",content:e.result},W);t.appendChild(n)}if(void 0!==e.nextButtons){var l=F.find((function(t){return t.endpoint===e.nextButtons}));if(l){var o=g({role:"assistant",content:l.title.title},W);t.appendChild(o),l.texts.length>0&&(S=b(l.texts,d),t.appendChild(S))}else{var r=g({role:"assistant",content:"Error"},W);t.appendChild(r)}}t.scrollTop=t.scrollHeight,N=!1})).catch((function(e){console.log(e);try{t.removeChild(i)}catch(t){}var n=g({role:"assistant",content:"Error"},W);t.appendChild(n),t.scrollTop=t.scrollHeight,N=!1}))}})),f=o(h,u,p);if(Object.keys(w).length>1){var x=function(t){var e=document.createElement("div");e.id="FiEnButton",e.style.width="70px",e.style.height="25px",e.style.position="absolute",e.style.top="10px",e.style.right="100px",e.style.display="flex",e.style.flexDirection="row",e.style.alignItems="center",e.style.textAlign="center",e.style.borderRadius="12px";var n=document.createElement("div");n.innerText="FI",n.style.width="35px",n.style.height="25px",n.style.borderRadius="12px",n.style.cursor="pointer",n.style.backgroundColor="white",n.style.color="#041F3E",n.addEventListener("click",(function(){t("finnish")&&(n.style.color="#041F3E",n.style.backgroundColor="white",l.style.color="white",l.style.backgroundColor="#041F3E")}));var l=document.createElement("div");return l.innerText="EN",l.style.width="35px",l.style.height="25px",l.style.borderRadius="12px",l.style.cursor="pointer",l.addEventListener("click",(function(){t("english")&&(l.style.color="#041F3E",l.style.backgroundColor="white",n.style.color="white",n.style.backgroundColor="#041F3E")})),e.appendChild(n),e.appendChild(l),e}((function(t){if(!N&&B!==t)return N=!0,O=null,W=[],a=(F=w[t]).find((function(t){return"0"===t.title.connection})),k=a?{role:"assistant",content:a.title.title}:"english"===t?{role:"assistant",content:"Hi, how can I help you?"}:{role:"assistant",content:"Hei, miten voin auttaa?"},T=g(k,W),B=t,N=!1,p(),!0}));f.appendChild(x)}h.appendChild(f),h.appendChild(t),h.appendChild(m),(A=document.createElement("buttonContainer")).appendChild(u),A.appendChild(h),j.concat(I).length>0&&(!j.includes(window.location.pathname.split("/")[1])||I.includes(window.location.pathname.split("/")[1]))&&(A.style.display="none"),u.addEventListener("click",(function(){var t;t=h,u.style.display="none",t.style.display="flex"})),document.body.appendChild(A)}))})();